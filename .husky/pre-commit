#!/usr/bin/env sh
. "$(dirname "$0")/husky.sh"

set -e  # Exit immediately if a command fails

echo "ğŸš€ Running pre-commit checks..."

echo "1. ğŸ“‹ Validating branch name..."
npx --no-install branch-name-lint

echo "2. ğŸ“ Validating commit message..."
# Get the commit message file (temporary file created by git)
COMMIT_MSG_FILE="$1"
# If not provided (in pre-commit), use default .git/COMMIT_EDITMSG
if [ -z "$COMMIT_MSG_FILE" ]; then
  COMMIT_MSG_FILE=".git/COMMIT_EDITMSG"
fi

# Check if commit message file exists
if [ -f "$COMMIT_MSG_FILE" ]; then
  npx --no-install commitlint --edit "$COMMIT_MSG_FILE"
else
  echo "âš ï¸  No commit message file found. Skipping commitlint."
fi

echo "3. ğŸ”§ Running lint-staged..."
npx --no-install lint-staged

echo "âœ… All pre-commit checks passed!"
